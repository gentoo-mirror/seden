--- a/configure.ac	2016-11-08 08:25:08.329359284 +0100
+++ b/configure.ac	2016-11-08 08:36:34.266365426 +0100
@@ -259,6 +259,49 @@
 dnl ---------------------------------------------------------------------------
 AC_PATH_PROG([XSLTPROC], [xsltproc])
 
+# elogind
+
+AC_ARG_ENABLE([elogind],
+              AS_HELP_STRING([--enable-elogind], [Use elogind]),
+              [enable_elogind=$enableval],
+              [enable_elogind=auto])
+
+if test x$enable_elogind != xno; then
+   PKG_CHECK_MODULES(ELOGIND, [libelogind >= 219],
+			                     [have_elogind=yes], [have_elogind=no])
+else
+   have_elogind=no
+fi
+
+AC_MSG_CHECKING([whether to use elogind])
+
+if test x$enable_elogind = xauto ; then
+        if test x$have_elogind = xno ; then
+                enable_elogind=no
+        else
+                enable_elogind=yes
+        fi
+fi
+
+AC_MSG_RESULT($enable_elogind)
+
+if test x$enable_elogind = xyes; then
+        if test x$have_elogind = xno; then
+                AC_MSG_ERROR([elogind support explicitly required, but libelogind not found])
+        fi
+        AC_DEFINE(HAVE_ELOGIND, 1, [Define if elogind is used])
+fi
+AC_SUBST(ELOGIND_CFLAGS)
+AC_SUBST(ELOGIND_LIBS)
+
+LIBACCOUNTSSERVICE_LIBS="$LIBACCOUNTSSERVICE_LIBS $ELOGIND_LIBS"
+LIBACCOUNTSSERVICE_CFLAGS="$LIBACCOUNTSSERVICE_CFLAGS $ELOGIND_CFLAGS"
+
+if test "x$have_elogind" != "xno" ; then
+        AC_DEFINE(WITH_ELOGIND, 1, [Define to enable elogind support])
+fi
+
+
 # systemd
 
 AC_ARG_ENABLE([systemd],
@@ -267,8 +310,14 @@
               [enable_systemd=auto])
 
 if test x$enable_systemd != xno; then
-   PKG_CHECK_MODULES(SYSTEMD, [libsystemd >= 186],
+   if test x$enable_elogind = yes; then
+           AC_MSG_NOTICE([Systemd support requested, but elogind found])
+           have_systemd=no
+           enable_systemd=no
+   else
+           PKG_CHECK_MODULES(SYSTEMD, [libsystemd >= 186],
 			                     [have_systemd=yes], [have_systemd=no])
+   fi
 else
    have_systemd=no
 fi
@@ -312,6 +361,7 @@
     AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])
 fi
 AM_CONDITIONAL(HAVE_SYSTEMD, [test -n "$with_systemdsystemunitdir" -a "x$with_systemdsystemunitdir" != "xno" ])
+AM_CONDITIONAL(HAVE_ELOGIND, [test -n "$with_systemdsystemunitdir" -a "x$with_systemdsystemunitdir" != "xno" ])
 
 AC_CONFIG_HEADERS([config.h])
 AC_CONFIG_FILES([
--- a/data/Makefile.am	2016-11-08 08:38:33.550366494 +0100
+++ b/data/Makefile.am	2016-11-08 08:41:36.676368134 +0100
@@ -29,6 +29,15 @@
 
 endif
 
+if HAVE_ELOGIND
+systemdsystemunit_DATA = \
+	accounts-daemon.service
+
+accounts-daemon.service: accounts-daemon.service.in
+	@sed -e "s|\@libexecdir\@|$(libexecdir)|" $< >$@
+
+endif
+
 EXTRA_DIST = 			\
 	$(dbusif_DATA)		\
 	$(dbusconf_DATA)	\
--- a/src/libaccountsservice/act-user-manager.c	2016-11-08 08:43:23.225369088 +0100
+++ b/src/libaccountsservice/act-user-manager.c	2016-11-08 08:46:02.297370512 +0100
@@ -43,7 +43,13 @@
 
 #ifdef WITH_SYSTEMD
 #include <systemd/sd-login.h>
+#endif
+
+#ifdef WITH_ELOGIND
+#include <elogind/sd-login.h>
+#endif
 
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 /* check if logind is running */
 #define LOGIND_RUNNING() (access("/run/systemd/seats/", F_OK) >= 0)
 #endif
@@ -120,7 +126,7 @@
         ConsoleKitSeat              *seat_proxy;
         ConsoleKitSession           *session_proxy;
         guint                        load_idle_id;
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         sd_login_monitor            *session_monitor;
         GInputStream                *session_monitor_stream;
         guint                        session_monitor_source_id;
@@ -299,7 +305,7 @@
         return TRUE;
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static gboolean
 activate_systemd_session_id (ActUserManager *manager,
                              const char     *seat_id,
@@ -384,7 +390,7 @@
         return ret;
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static gboolean
 _systemd_session_is_login_window (ActUserManager *manager,
                                   const char     *session_id)
@@ -418,7 +424,7 @@
 session_is_login_window (ActUserManager *manager,
                          const char     *session_id)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 return _systemd_session_is_login_window (manager, session_id);
         }
@@ -435,7 +441,7 @@
         return TRUE;
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static gboolean
 _systemd_session_is_on_our_seat (ActUserManager *manager,
                                  const char     *session_id)
@@ -470,7 +476,7 @@
 session_is_on_our_seat (ActUserManager *manager,
                         const char     *session_id)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 return _systemd_session_is_on_our_seat (manager, session_id);
         }
@@ -510,7 +516,7 @@
 
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 gboolean
 _can_activate_systemd_sessions (ActUserManager *manager)
 {
@@ -571,7 +577,7 @@
         g_debug ("ActUserManager: checking if seat can activate sessions");
 
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 return _can_activate_systemd_sessions (manager);
         }
@@ -616,7 +622,7 @@
                 goto out;
         }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 return activate_systemd_session_id (manager, manager->priv->seat.id, ssid);
         }
@@ -743,7 +749,7 @@
         g_object_unref (manager);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static void
 _get_systemd_seat_id (ActUserManager *manager)
 {
@@ -773,7 +779,7 @@
 static void
 get_seat_id_for_current_session (ActUserManager *manager)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 _get_systemd_seat_id (manager);
                 return;
@@ -1182,7 +1188,7 @@
         g_object_unref (manager);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static void
 _get_current_systemd_session_id (ActUserManager *manager)
 {
@@ -1213,7 +1219,7 @@
 static void
 get_current_session_id (ActUserManager *manager)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 _get_current_systemd_session_id (manager);
                 return;
@@ -1297,7 +1303,7 @@
 get_proxy_for_new_session (ActUserManagerNewSession *new_session)
 {
         GError            *error = NULL;
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 new_session->state++;
                 load_new_session_incrementally (new_session);
@@ -1363,7 +1369,7 @@
         load_new_session_incrementally (new_session);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static void
 _get_uid_for_new_systemd_session (ActUserManagerNewSession *new_session)
 {
@@ -1390,7 +1396,7 @@
 static void
 get_uid_for_new_session (ActUserManagerNewSession *new_session)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 _get_uid_for_new_systemd_session (new_session);
                 return;
@@ -1615,7 +1621,7 @@
         load_new_session_incrementally (new_session);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static void
 _get_x11_display_for_new_systemd_session (ActUserManagerNewSession *new_session)
 {
@@ -1670,7 +1676,7 @@
 static void
 get_x11_display_for_new_session (ActUserManagerNewSession *new_session)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 _get_x11_display_for_new_systemd_session (new_session);
                 return;
@@ -1822,7 +1828,7 @@
         _remove_session (manager, session_id);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 
 static gboolean
 _session_recognized (ActUserManager *manager,
@@ -1924,7 +1930,7 @@
         g_slist_free (sessions_to_remove);
 }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
 static void
 reload_systemd_sessions (ActUserManager *manager)
 {
@@ -2044,7 +2050,7 @@
 {
         GError *error = NULL;
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 _monitor_for_systemd_session_changes (manager);
                 manager->priv->seat.state++;
@@ -2117,7 +2123,7 @@
 static void
 get_session_proxy (ActUserManager *manager)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 manager->priv->seat.state++;
                 queue_load_seat_incrementally (manager);
@@ -2550,7 +2556,7 @@
 static void
 load_sessions (ActUserManager *manager)
 {
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (LOGIND_RUNNING()) {
                 reload_systemd_sessions (manager);
                 maybe_set_is_loaded (manager);
@@ -2958,7 +2964,7 @@
                 g_source_remove (manager->priv->seat.load_idle_id);
         }
 
-#ifdef WITH_SYSTEMD
+#if defined(WITH_SYSTEMD) || defined(WITH_ELOGIND)
         if (manager->priv->seat.session_monitor != NULL) {
                 sd_login_monitor_unref (manager->priv->seat.session_monitor);
         }
